<!-- index.html -->
<!DOCTYPE html>
<html>
<head>
    <title>교육용 AI 챗봇</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        #chat { display: none; } /* 처음엔 채팅창 숨김 */
    </style>
</head>
<body>
    <!-- 로그인 화면 -->
    <div id="login">
        <h3>🔒 교육용 접속 코드</h3>
        <input type="password" id="code" placeholder="비밀코드 입력">
        <input type="text" id="name" placeholder="이름 입력">
        <button onclick="checkCode()">시작하기</button>
    </div>

    <!-- 채팅 화면 -->
    <div id="chat">
        <div id="messages"></div>
        <input type="text" id="input">
        <button onclick="send()">전송</button>
    </div>

    <script>
        // 1. 기본 설정
    let userName = "";
    const SECRET_CODE = "hello123"; // 원하는 비밀번호로 변경하세요!

    // 2. 비밀번호 확인 함수
    function checkCode() {
        const inputCode = document.getElementById('code').value;
        userName = document.getElementById('name').value;
    
        if(inputCode === SECRET_CODE && userName) {
           document.getElementById('login').style.display = 'none';
            document.getElementById('chat').style.display = 'block';
        } else {
            alert('❌ 잘못된 코드 또는 이름입니다!');
        }
    }

// 3. 채팅 기능 (API 키는 다음 단계에서 수정)
async function send() {
    const input = document.getElementById('input').value;
    const messagesDiv = document.getElementById('messages');
    
    // 사용자 메시지 표시
    messagesDiv.innerHTML += `<div>👤 ${userName}: ${input}</div>`;
    
    // Cloudflare Worker 주소 사용
    const response = await fetch('https://tongdo-api.aelagth.workers.dev', {
        method: 'POST',
        body: JSON.stringify({
            model: "gpt-3.5-turbo",
            messages: [{role: "user", content: input}]
        })
    });

    const data = await response.json();
    messagesDiv.innerHTML += `<div>🤖 AI: ${data.choices[0].message.content}</div>`;
}
    </script>
</body>
</html>
