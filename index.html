<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pandas 연습 문제 풀이</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Prism.js CSS (Okaidia Theme) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <!-- Prism.js core CSS (needed for line numbers, etc. if used later) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.css" rel="stylesheet" />
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 1rem;
            background-color: #f3f4f6; /* bg-gray-100 */
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1); /* shadow-sm */
        }
        .problem {
            margin-bottom: 1.5rem; /* mb-6 */
            padding: 1rem;
            background-color: #fff; /* bg-white */
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1); /* shadow-sm */
        }
        .question {
            font-size: 1.25rem; /* text-xl */
            font-weight: 500; /* font-semibold */
            margin-bottom: 0.5rem; /* mb-2 */
            color: #1f2937; /* text-gray-800 */
            cursor: pointer; /* 클릭 가능 표시 */
            position: relative; /* For positioning the ::before element */
            padding-left: 20px; /* Space for the +/- icon */
        }
        /* Toggle indicator */
        .question::before {
            content: '+ '; /* 닫혔을 때 표시 */
            font-weight: bold;
            position: absolute; /* Position relative to the parent */
            left: 0;
            top: 0; /* Adjust as needed */
            /* display: inline-block; removed */
            /* margin-right: 5px; removed */
        }
        .question.open::before {
            content: '- '; /* 열렸을 때 표시 */
        }
        .question-number {
            font-weight: 600; /* semibold */
            margin-right: 0.5rem; /* 번호와 텍스트 간격 */
            /* display: inline-block; */ /* Let it flow naturally */
        }
        .question-text {
             /* display: inline; */ /* Let it flow naturally */
             text-decoration: none; /* 밑줄 제거 */
            white-space: normal; /* Allow text wrapping */
            overflow-wrap: break-word; /* Break long words/URLs */
            word-break: break-word; /* Ensure wrapping */
            display: inline-block; /* Allow width calculation */
            width: calc(100% - 25px); /* Adjust width for icon/padding */
            vertical-align: top; /* Align with number */
        }

        /* User Input Area */
        .user-input {
            width: 100%;
            min-height: 150px; /* 높이 증가 */
            margin-top: 0.5rem; /* mb-2 */
            margin-bottom: 0.5rem; /* mb-2 */
            padding: 0.75rem; /* 패딩 증가 */
            /* border: 1px solid #d1d5db; /* 기존 테두리 제거 */
            border: 1px solid #3a3d41; /* VS Code 스타일 테두리 */
            border-radius: 0.375rem; /* rounded-md */
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace; /* 고정폭 폰트 */
            font-size: 0.95rem; /* 폰트 크기 조정 */
            background-color: #1e1e1e; /* VS Code 다크 배경 */
            color: #d4d4d4; /* VS Code 밝은 글자색 */
            display: none; /* 기본적으로 숨김 */
            box-sizing: border-box; /* Include padding and border in the element's total width and height */
            line-height: 1.5; /* 줄 간격 조정 */
            white-space: pre; /* 공백/줄바꿈 유지 (코드 형식) */
            overflow-wrap: normal; /* 자동 줄바꿈 비활성 */
            overflow-x: auto; /* 가로 스크롤 추가 */
        }
        /* 틀렸을 때 스타일 - 제거됨 */
        /* .user-input.incorrect {
            border: 2px solid #f44336; /* 빨간색 테두리 * /
        } */
        /* Check Answer Button */
        .check-answer-btn {
            display: none; /* 기본적으로 숨김 */
            padding: 0.5rem 1rem; /* py-2 px-4 */
            background-color: #3b82f6; /* bg-blue-500 */
            color: white;
            border: none;
            border-radius: 0.375rem; /* rounded-md */
            cursor: pointer;
            margin-bottom: 0.5rem; /* mb-2 */
            transition: background-color 0.2s;
        }
        .check-answer-btn:hover {
            background-color: #2563eb; /* bg-blue-600 */
        }

        .answer {
            font-size: 1rem; /* text-base */
            margin-bottom: 0.5rem; /* mb-2 */
            /* color: #374151; /* text-gray-700 - Handled by Prism */
            /* white-space: pre-wrap; /* Handled by Prism pre/code */
            /* background-color: #e5e7eb; /* bg-gray-200 - Handled by Prism */
            padding: 0; /* Let Prism handle padding */
            border-radius: 0.375rem; /* rounded-md */
            overflow-x: auto;  /* Add horizontal scrollbar for long code */
            display: none; /* 기본적으로 숨김 */
            border: 1px dashed #9ca3af; /* Optional: dashed border */
            position: relative; /* Needed for copy button positioning */
        }
        .code-comment {
            font-size: 0.875rem; /* text-sm */
            color: #6b7280; /* text-gray-500 */
            margin-bottom: 0.25rem; /* mb-1 */
            margin-top: 0.5rem; /* Add some space above */
            padding: 0.5rem;
            background-color: #f9fafb; /* bg-gray-50 */
            border-left: 3px solid #d1d5db; /* border-gray-300 */
            display: none; /* 기본적으로 숨김 */
        }
        /* Style for pre/code inside answer for Prism */
        .answer pre[class*="language-"] {
           margin: 0 !important;
           border-radius: 0.375rem; /* Match container */
           /* background-color: transparent !important; /* Let Prism theme handle it */
           padding: 1em !important; /* Consistent padding */
           font-size: 0.9em; /* Adjust code font size if needed */
           white-space: pre-wrap;   /* Wrap long lines */
           word-wrap: break-word;   /* Break words if necessary */
        }
        .answer code[class*="language-"] {
           font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace; /* Consistent monospaced font */
           line-height: 1.5;
           white-space: pre-wrap;   /* Wrap long lines */
           word-wrap: break-word;   /* Break words if necessary */
        }

        /* Basic mobile responsiveness adjustments */
        @media (max-width: 640px) { /* sm breakpoint example */
            .container {
                margin: 1rem auto;
                padding: 0.75rem;
            }
            .question {
                font-size: 1.1rem; /* text-lg */
                padding-left: 18px; /* Adjust icon spacing */
            }
            .answer, .user-input {
                font-size: 0.9rem;
            }
        }

    </style>
</head>
<body class="bg-gray-100">
    <div class="container">
        <h1 class="text-2xl font-semibold mb-4 text-gray-800">Pandas 연습 문제 풀이</h1>

        <div class="problem" data-question-id="q1">
            <h2 class="question"><span class="question-number">Question 1:</span><span class="question-text">다음 URL의 데이터를 로드하라. 데이터는 \t을 기준으로 구분되어있다.<br>(URL: https://raw.githubusercontent.com/Datamanim/pandas/main/lol.csv)</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">DataUrl = 'https://raw.githubusercontent.com/Datamanim/pandas/main/lol.csv'
df = pd.read_csv(DataUrl, sep='\t')
print(df)
</code></pre>
            </div>
            <p class="code-comment">
                # `pd.read_csv(DataUrl, sep='\\t')`: 지정된 URL에서 데이터를 로드합니다. `sep='\\t'`는 데이터가 탭으로 구분되었음을 의미합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q2">
            <h2 class="question"><span class="question-number">Question 2:</span><span class="question-text">데이터의 상위 5개 행을 출력하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.head(5)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.head(5)`: 데이터프레임의 처음 5개 행을 선택합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q3">
            <h2 class="question"><span class="question-number">Question 3:</span><span class="question-text">데이터의 행과 열의 갯수를 파악하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">print(df.shape)
print('행:',df.shape[0])
print('열:',df.shape[1])
</code></pre>
            </div>
            <p class="code-comment">
                # `df.shape`: 데이터프레임의 행과 열 개수를 (행, 열) 튜플로 반환합니다.
                # `df.shape[0]`: 행 개수를 반환합니다.
                # `df.shape[1]`: 열 개수를 반환합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q4">
            <h2 class="question"><span class="question-number">Question 4:</span><span class="question-text">전체 컬럼을 출력하라</span></h2>
             <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
             <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.columns
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.columns`: 데이터프레임의 모든 컬럼 이름을 반환합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q5">
             <h2 class="question"><span class="question-number">Question 5:</span><span class="question-text">6번째 컬럼명을 출력하라</span></h2>
             <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
             <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.columns[5]
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.columns[5]`: 데이터프레임의 6번째(인덱스 5) 컬럼 이름을 반환합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q6">
             <h2 class="question"><span class="question-number">Question 6:</span><span class="question-text">6번째 컬럼의 데이터 타입을 확인하라</span></h2>
             <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
             <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.iloc[:,5].dtype
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.iloc[:,5]`: 데이터프레임의 모든 행과 6번째(인덱스 5) 열을 선택합니다.
                # `.dtype`: 선택된 시리즈(컬럼)의 데이터 타입을 반환합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q7">
             <h2 class="question"><span class="question-number">Question 7:</span><span class="question-text">데이터셋의 인덱스 구성은 어떤가</span></h2>
             <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
             <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.index
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.index`: 데이터프레임의 인덱스 객체를 반환합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q8">
             <h2 class="question"><span class="question-number">Question 8:</span><span class="question-text">6번째 컬럼의 3번째 값은 무엇인가?</span></h2>
             <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
             <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.iloc[2,5]
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.iloc[2,5]`: 데이터프레임의 3번째 행(인덱스 2)과 6번째 열(인덱스 5)에 위치한 값을 선택합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q9">
             <h2 class="question"><span class="question-number">Question 9:</span><span class="question-text">다음 URL의 데이터를 로드하라. 컬럼이 한글이기에 적절한 처리해줘야함<br>(URL: https://raw.githubusercontent.com/Datamanim/pandas/main/Jeju.csv)</span></h2>
             <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
             <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">DataUrl = 'https://raw.githubusercontent.com/Datamanim/pandas/main/Jeju.csv'
df = pd.read_csv(DataUrl,encoding='euc-kr')
print(df)
</code></pre>
            </div>
            <p class="code-comment">
                # `pd.read_csv(DataUrl, encoding='euc-kr')`: 지정된 URL의 CSV 파일을 로드합니다. 한글 컬럼명을 위해 `encoding='euc-kr'`를 사용합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q10">
              <h2 class="question"><span class="question-number">Question 10:</span><span class="question-text">데이터 마지막 3개행을 출력하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.tail(3)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.tail(3)`: 데이터프레임의 마지막 3개 행을 선택합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q11">
              <h2 class="question"><span class="question-number">Question 11:</span><span class="question-text">수치형 변수를 가진 컬럼을 출력하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.select_dtypes(exclude=object).columns
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.select_dtypes(exclude=object)`: 데이터프레임에서 `object` 타입(주로 문자열)을 제외한 컬럼들을 선택합니다.
                # `.columns`: 선택된 데이터프레임의 컬럼 이름들을 반환합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q12">
              <h2 class="question"><span class="question-number">Question 12:</span><span class="question-text">범주형 변수를 가진 컬럼을 출력하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.select_dtypes(include=object).columns
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                 # `df.select_dtypes(include=object)`: 데이터프레임에서 `object` 타입(주로 문자열)인 컬럼들을 선택합니다.
                 # `.columns`: 선택된 데이터프레임의 컬럼 이름들을 반환합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q13">
              <h2 class="question"><span class="question-number">Question 13:</span><span class="question-text">각 컬럼의 결측치 숫자를 파악하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.isnull().sum()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.isnull()`: 데이터프레임의 각 셀이 결측치(NaN)인지 여부를 boolean 값으로 반환합니다.
                # `.sum()`: 각 컬럼별로 True 값(결측치)의 개수를 합산합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q14">
              <h2 class="question"><span class="question-number">Question 14:</span><span class="question-text">각 컬럼의 데이터수, 데이터타입을 한번에 확인하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df.info()
</code></pre>
            </div>
            <p class="code-comment">
                # `df.info()`: 데이터프레임의 간략한 요약 정보(인덱스 타입, 컬럼 정보, non-null 개수, 데이터 타입, 메모리 사용량 등)를 출력합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q15">
              <h2 class="question"><span class="question-number">Question 15:</span><span class="question-text">각 수치형 변수의 분포(사분위, 평균, 표준편차, 최대 , 최소)를 확인하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.describe()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.describe()`: 데이터프레임의 수치형 컬럼에 대한 기술 통계(개수, 평균, 표준편차, 최소값, 사분위수, 최대값)를 계산합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q16">
              <h2 class="question"><span class="question-number">Question 16:</span><span class="question-text">거주인구 컬럼의 값들을 출력하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df['거주인구']
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df['거주인구']`: 데이터프레임에서 '거주인구' 컬럼을 선택합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q17">
              <h2 class="question"><span class="question-number">Question 17:</span><span class="question-text">평균 속도 컬럼의 4분위 범위(IQR) 값을 구하여라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans  = df['평균 속도'].quantile(0.75) -df['평균 속도'].quantile(0.25)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df['평균 속도'].quantile(0.75)`: '평균 속도' 컬럼의 75% 백분위수(Q3)를 계산합니다.
                # `df['평균 속도'].quantile(0.25)`: '평균 속도' 컬럼의 25% 백분위수(Q1)를 계산합니다.
                # IQR (사분위 범위) = Q3 - Q1 입니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q18">
              <h2 class="question"><span class="question-number">Question 18:</span><span class="question-text">읍면동명 컬럼의 유일값 갯수를 출력하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.읍면동명.nunique()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.읍면동명.nunique()`: '읍면동명' 컬럼의 고유한 값(유일값)의 개수를 계산합니다. `df['읍면동명'].nunique()`와 동일합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q19">
              <h2 class="question"><span class="question-number">Question 19:</span><span class="question-text">읍면동명 컬럼의 유일값을 모두 출력하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.읍면동명.unique()
print(Ans)
</code></pre>
            </div>
             <p class="code-comment">
                # `df.읍면동명.unique()`: '읍면동명' 컬럼의 고유한 값(유일값)들을 NumPy 배열 형태로 반환합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q20">
             <h2 class="question"><span class="question-number">Question 20:</span><span class="question-text">다음 URL의 데이터를 로드하라.<br>(URL: https://raw.githubusercontent.com/Datamanim/pandas/main/chipo.csv)</span></h2>
             <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
             <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python"># Question 20부터 사용할 데이터 로드
DataUrl = 'https://raw.githubusercontent.com/Datamanim/pandas/main/chipo.csv'
df = pd.read_csv(DataUrl)
Ans = type(df)
print(Ans) # 로드된 데이터 타입 확인
# print(df.head()) # 데이터 확인용 출력 추가 (필요 시 주석 해제)
</code></pre>
            </div>
            <p class="code-comment">
                # `pd.read_csv(DataUrl)`: 지정된 URL의 CSV 파일을 로드하여 데이터프레임을 생성합니다.
                # `type(df)`: 로드된 객체(`df`)의 타입을 확인합니다(여기서는 DataFrame).
            </p>
        </div>

        <div class="problem" data-question-id="q21">
               <h2 class="question"><span class="question-number">Question 21:</span><span class="question-text">quantity컬럼 값이 3인 데이터를 추출하여 첫 5행을 출력하라</span></h2>
               <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
               <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.loc[df['quantity']==3].head()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.loc[df['quantity']==3]`: 'quantity' 컬럼 값이 3인 행들을 레이블 기반으로 선택합니다.
                # `.head()`: 선택된 결과의 처음 5개 행을 반환합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q22">
               <h2 class="question"><span class="question-number">Question 22:</span><span class="question-text">quantity컬럼 값이 3인 데이터를 추출하여 index를 0부터 정렬하고 첫 5행을 출력하라</span></h2>
               <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
               <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.loc[df['quantity']==3].head().reset_index(drop=True)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.loc[df['quantity']==3]`: 'quantity' 컬럼 값이 3인 행들을 선택합니다.
                # `.head()`: 선택된 결과의 처음 5개 행을 반환합니다.
                # `.reset_index(drop=True)`: 기존 인덱스를 제거하고 0부터 시작하는 새로운 정수 인덱스를 설정합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q23">
            <h2 class="question"><span class="question-number">Question 23:</span><span class="question-text">quantity , item_price 두개의 컬럼으로 구성된 새로운 데이터 프레임을 정의하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans =df[['quantity','item_price']]
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df[['quantity','item_price']]`: 데이터프레임에서 'quantity'와 'item_price' 두 개의 컬럼을 선택하여 새로운 데이터프레임을 생성합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q24">
              <h2 class="question"><span class="question-number">Question 24:</span><span class="question-text">item_price 컬럼의 달러표시 문자를 제거하고 float 타입으로 저장하여 new_price 컬럼에 저장하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df['new_price'] = df['item_price'].str[1:].astype('float')
Ans = df['new_price'].head()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df['item_price'].str[1:]`: 'item_price' 컬럼의 각 문자열에서 첫 번째 문자(인덱스 0)를 제외한 나머지 부분을 선택합니다 (달러 기호 제거).
                # `.astype('float')`: 선택된 문자열 시리즈를 부동소수점(float) 타입으로 변환합니다.
                # `df['new_price'] = ...`: 변환된 결과를 'new_price'라는 새로운 컬럼에 저장합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q25">
              <h2 class="question"><span class="question-number">Question 25:</span><span class="question-text">new_price값이 5이하의 값을 가지는 데이터프레임을 추출하고,<br>전체 갯수를 구하여라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = len(df.loc[df.new_price <=5])
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.loc[df.new_price <= 5]`: 'new_price' 컬럼 값이 5 이하인 행들을 선택합니다.
                # `len(...)`: 선택된 데이터프레임의 행의 개수를 반환합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q26">
              <h2 class="question"><span class="question-number">Question 26:</span><span class="question-text">item_name명이 Chicken Salad Bowl 인 데이터 프레임을 추출하고<br>index 값을 초기화 하여라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.loc[df.item_name =='Chicken Salad Bowl'].reset_index(drop=True)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.loc[df.item_name == 'Chicken Salad Bowl']`: 'item_name' 컬럼 값이 'Chicken Salad Bowl'인 행들을 선택합니다.
                # `.reset_index(drop=True)`: 선택된 결과의 인덱스를 초기화합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q27">
              <h2 class="question"><span class="question-number">Question 27:</span><span class="question-text">new_price값이 9 이하이고 item_name 값이 Chicken Salad Bowl인 데이터 프레임을 추출하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.loc[(df.item_name =='Chicken Salad Bowl') & (df.new_price <= 9)]
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.loc[...]`: 여러 조건을 만족하는 행들을 선택합니다.
                # `(df.item_name == 'Chicken Salad Bowl')`: 첫 번째 조건 (item_name 확인).
                # `(df.new_price <= 9)`: 두 번째 조건 (new_price 확인).
                # `&`: 두 조건을 모두 만족해야 함 (AND 연산).
            </p>
        </div>
        
        <div class="problem" data-question-id="q28">
              <h2 class="question"><span class="question-number">Question 28:</span><span class="question-text">df의 new_price 컬럼 값에 따라 오름차순으로 정리하고 index를 초기화 하여라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.sort_values('new_price').reset_index(drop=True)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.sort_values('new_price')`: 데이터프레임을 'new_price' 컬럼 기준으로 오름차순 정렬합니다.
                # `.reset_index(drop=True)`: 정렬된 결과의 인덱스를 초기화합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q29">
              <h2 class="question"><span class="question-number">Question 29:</span><span class="question-text">df의 item_name 컬럼 값중 Chips 포함하는 경우의 데이터를 출력하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.loc[df.item_name.str.contains('Chips')]
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.item_name.str.contains('Chips')`: 'item_name' 컬럼의 각 문자열 값에 'Chips'가 포함되어 있는지 확인합니다.
                # `df.loc[...]`: 위 조건이 True인 행들을 선택합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q30">
              <h2 class="question"><span class="question-number">Question 30:</span><span class="question-text">df의 짝수번째 컬럼만을 포함하는 데이터프레임을 출력하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.iloc[:,::2]
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.iloc[:, ::2]`: 데이터프레임의 모든 행(`:`)과 짝수 번째 컬럼(`::2`, 0번부터 시작하여 2칸 간격)을 정수 위치 기반으로 선택합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q31">
              <h2 class="question"><span class="question-number">Question 31:</span><span class="question-text">df의 new_price 컬럼 값에 따라 내림차순으로 정리하고 index를 초기화 하여라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.sort_values('new_price',ascending=False).reset_index(drop=True)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.sort_values('new_price', ascending=False)`: 데이터프레임을 'new_price' 컬럼 기준으로 내림차순 정렬합니다.
                # `.reset_index(drop=True)`: 정렬된 결과의 인덱스를 초기화합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q32">
              <h2 class="question"><span class="question-number">Question 32:</span><span class="question-text">df의 item_name 컬럼 값이 Steak Salad 또는 Bowl 인 데이터를 인덱싱하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.loc[(df.item_name =='Steak Salad') | (df.item_name =='Bowl')]
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.loc[...]`: 여러 조건을 만족하는 행들을 선택합니다.
                # `(df.item_name == 'Steak Salad')`: 첫 번째 조건.
                # `(df.item_name == 'Bowl')`: 두 번째 조건.
                # `|`: 두 조건 중 하나라도 만족하면 됨 (OR 연산).
            </p>
        </div>
        
        <div class="problem" data-question-id="q33">
              <h2 class="question"><span class="question-number">Question 33:</span><span class="question-text">df의 item_name 컬럼 값이 Steak Salad 또는 Bowl 인 데이터를 데이터 프레임화 한 후,<br>item_name를 기준으로 중복행이 있으면 제거하되 첫번째 케이스만 남겨라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.loc[(df.item_name =='Steak Salad') | (df.item_name =='Bowl')]
Ans = Ans.drop_duplicates('item_name')
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.loc[...]`: 'item_name'이 'Steak Salad' 또는 'Bowl'인 행을 선택합니다.
                # `Ans.drop_duplicates('item_name')`: 선택된 데이터프레임(`Ans`)에서 'item_name' 컬럼 기준으로 중복된 행을 제거하되, 첫 번째 행만 남깁니다. (기본값 `keep='first'`)
            </p>
        </div>
        
        <div class="problem" data-question-id="q34">
              <h2 class="question"><span class="question-number">Question 34:</span><span class="question-text">df의 item_name 컬럼 값이 Steak Salad 또는 Bowl 인 데이터를 데이터 프레임화 한 후,<br>item_name를 기준으로 중복행이 있으면 제거하되 마지막 케이스만 남겨라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.loc[(df.item_name =='Steak Salad') | (df.item_name =='Bowl')]
Ans = Ans.drop_duplicates('item_name',keep='last')
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.loc[...]`: 'item_name'이 'Steak Salad' 또는 'Bowl'인 행을 선택합니다.
                # `Ans.drop_duplicates('item_name', keep='last')`: 선택된 데이터프레임(`Ans`)에서 'item_name' 컬럼 기준으로 중복된 행을 제거하되, 마지막 행만 남깁니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q35">
              <h2 class="question"><span class="question-number">Question 35:</span><span class="question-text">df의 데이터 중 new_price값이 new_price값의 평균값 이상을 가지는<br>데이터들을 인덱싱하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.loc[df.new_price >= df.new_price.mean()]
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.new_price.mean()`: 'new_price' 컬럼의 평균값을 계산합니다.
                # `df.loc[df.new_price >= ... ]`: 'new_price' 컬럼 값이 계산된 평균값 이상인 행들을 선택합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q36">
              <h2 class="question"><span class="question-number">Question 36:</span><span class="question-text">df의 데이터 중 item_name의 값이 Izze 데이터를 Fizzy Lizzy로 수정하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df.loc[df.item_name =='Izze','item_name'] = 'Fizzy Lizzy'
Ans = df
# print(Ans.head()) # 수정 확인 (필요 시 주석 해제)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.loc[df.item_name == 'Izze', 'item_name'] = 'Fizzy Lizzy'`: 'item_name' 컬럼 값이 'Izze'인 행을 선택하고, 해당 행의 'item_name' 값을 'Fizzy Lizzy'로 수정합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q37">
              <h2 class="question"><span class="question-number">Question 37:</span><span class="question-text">df의 데이터 중 choice_description 값이 NaN 인 데이터의 갯수를 구하여라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.choice_description.isnull().sum()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.choice_description.isnull()`: 'choice_description' 컬럼의 각 값이 결측치(NaN)인지 확인합니다.
                # `.sum()`: True 값(결측치)의 개수를 합산합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q38">
              <h2 class="question"><span class="question-number">Question 38:</span><span class="question-text">df의 데이터 중 choice_description 값이 NaN 인 데이터를<br>NoData 값으로 대체하라(loc 이용)</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df.loc[df.choice_description.isnull(),'choice_description'] ='NoData'
Ans = df
# print(Ans.head()) # 수정 확인 (필요 시 주석 해제)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.loc[df.choice_description.isnull(), 'choice_description'] = 'NoData'`: 'choice_description' 컬럼 값이 결측치(NaN)인 행을 선택하고, 해당 행의 'choice_description' 값을 'NoData'로 수정합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q39">
              <h2 class="question"><span class="question-number">Question 39:</span><span class="question-text">df의 데이터 중 choice_description 값에 Black이 들어가는 경우를 인덱싱하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df[df.choice_description.str.contains('Black')]
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                 # `df.choice_description.str.contains('Black')`: 'choice_description' 컬럼의 각 문자열 값에 'Black'이 포함되어 있는지 확인합니다.
                 # `df[...]`: 위 조건이 True인 행들을 선택합니다 (boolean indexing).
            </p>
        </div>
        
        <div class="problem" data-question-id="q40">
              <h2 class="question"><span class="question-number">Question 40:</span><span class="question-text">df의 데이터 중 choice_description 값에 Vegetables 들어가지 않는 경우의<br>갯수를 출력하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = len(df.loc[~df.choice_description.str.contains('Vegetables')])
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.choice_description.str.contains('Vegetables')`: 'Vegetables'가 포함된 경우 True를 반환합니다.
                # `~`: boolean 결과를 반전시킵니다 (포함되지 않은 경우 True).
                # `df.loc[...]`: 조건이 True인 행(Vegetables 미포함)을 선택합니다.
                # `len(...)`: 선택된 행의 개수를 계산합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q41">
              <h2 class="question"><span class="question-number">Question 41:</span><span class="question-text">df의 데이터 중 item_name 값이 N으로 시작하는 데이터를 모두 추출하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df[df.item_name.str.startswith('N')]
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.item_name.str.startswith('N')`: 'item_name' 컬럼의 각 문자열 값이 'N'으로 시작하는지 확인합니다.
                # `df[...]`: 위 조건이 True인 행들을 선택합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q42">
              <h2 class="question"><span class="question-number">Question 42:</span><span class="question-text">df의 데이터 중 item_name 값의 문자열 길이가 15 이상인 데이터를 인덱싱하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans= df[df.item_name.str.len() >=15]
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                 # `df.item_name.str.len()`: 'item_name' 컬럼의 각 문자열 값의 길이를 계산합니다.
                 # `>= 15`: 길이가 15 이상인지 확인합니다.
                 # `df[...]`: 위 조건이 True인 행들을 선택합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q43">
              <h2 class="question"><span class="question-number">Question 43:</span><span class="question-text">df의 데이터 중 new_price값이 list에 해당하는 경우의 데이터 프레임을 구하고<br>그 갯수를 출력하라 lst =[1.69, 2.39, 3.39, 4.45, 9.25, 10.98, 11.75, 16.98]</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">lst =[1.69, 2.39, 3.39, 4.45, 9.25, 10.98, 11.75, 16.98]
Ans = df.loc[df.new_price.isin(lst)]
print(len(Ans)) # 갯수를 출력하라고 했으므로 len() 추가
</code></pre>
            </div>
            <p class="code-comment">
                # `df.new_price.isin(lst)`: 'new_price' 컬럼의 각 값이 주어진 리스트 `lst`에 포함되는지 확인합니다.
                # `df.loc[...]`: 위 조건이 True인 행들을 선택합니다.
                # `len(...)`: 선택된 행의 개수를 계산합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q44">
             <h2 class="question"><span class="question-number">Question 44:</span><span class="question-text">다음 URL의 데이터를 로드하고 상위 5개 행을 출력하라.<br>(URL: https://raw.githubusercontent.com/Datamanim/pandas/main/AB_NYC_2019.csv)</span></h2>
             <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
             <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python"># Question 44부터 사용할 데이터 로드
df= pd.read_csv('https://raw.githubusercontent.com/Datamanim/pandas/main/AB_NYC_2019.csv')
Ans =df.head(5)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `pd.read_csv(...)`: 지정된 URL의 CSV 파일을 로드합니다.
                # `df.head(5)`: 로드된 데이터프레임의 처음 5개 행을 선택합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q45">
              <h2 class="question"><span class="question-number">Question 45:</span><span class="question-text">데이터의 각 host_name의 빈도수를 구하고 host_name으로 정렬하여<br>상위 5개를 출력하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.groupby('host_name').size().sort_index().head(5)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.groupby('host_name').size()`: 'host_name' 컬럼 기준으로 그룹화하여 각 그룹의 크기(빈도수)를 계산합니다.
                # `.sort_index()`: 결과를 인덱스(host_name) 기준으로 오름차순 정렬합니다.
                # `.head(5)`: 정렬된 결과의 상위 5개를 선택합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q46">
              <h2 class="question"><span class="question-number">Question 46:</span><span class="question-text">데이터의 각 host_name의 빈도수를 구하고 빈도수 기준 내림차순 정렬한<br>데이터 프레임을 만들어라. 빈도수 컬럼은 counts로 명명하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.groupby('host_name').size().\
                    to_frame().rename(columns={0:'counts'}).\
                    sort_values('counts',ascending=False)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.groupby('host_name').size()`: 'host_name'별 빈도수를 계산합니다.
                # `.to_frame()`: 시리즈를 데이터프레임으로 변환합니다.
                # `.rename(columns={0:'counts'})`: 변환된 데이터프레임의 컬럼 이름(기본값 0)을 'counts'로 변경합니다.
                # `.sort_values('counts', ascending=False)`: 'counts' 컬럼 기준으로 내림차순 정렬합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q47">
              <h2 class="question"><span class="question-number">Question 47:</span><span class="question-text">neighbourhood_group의 값에 따른 neighbourhood 컬럼 값의 갯수를 구하여라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.groupby(['neighbourhood_group','neighbourhood'], as_index=False).size()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.groupby(['neighbourhood_group','neighbourhood'], as_index=False)`: 두 컬럼으로 그룹화하고, 그룹 키를 인덱스가 아닌 컬럼으로 유지합니다.
                # `.size()`: 각 그룹의 크기(행의 개수)를 계산하여 시리즈로 반환합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q48">
              <h2 class="question"><span class="question-number">Question 48:</span><span class="question-text">neighbourhood_group의 값에 따른 neighbourhood 컬럼 값 중<br>neighbourhood_group 그룹의 최댓값들을 출력하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans= df.groupby(['neighbourhood_group','neighbourhood'], as_index=False).size()\
                    .groupby(['neighbourhood_group'], as_index=False).max()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.groupby(['neighbourhood_group','neighbourhood'], as_index=False).size()`: Q47과 동일하게 그룹별 크기를 계산합니다.
                # `.groupby(['neighbourhood_group'], as_index=False)`: 결과를 다시 'neighbourhood_group'으로 그룹화합니다.
                # `.max()`: 각 'neighbourhood_group' 내에서 최대값(여기서는 size의 최댓값과 해당 neighbourhood)을 찾습니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q49">
              <h2 class="question"><span class="question-number">Question 49:</span><span class="question-text">neighbourhood_group 값에 따른 price 값의 평균, 분산, 최대, 최소 값을 구하여라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df[['neighbourhood_group','price']].groupby('neighbourhood_group').agg(['mean','var','max','min'])
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df[['neighbourhood_group','price']]`: 필요한 두 컬럼만 선택합니다.
                # `.groupby('neighbourhood_group')`: 'neighbourhood_group'으로 그룹화합니다.
                # `.agg(['mean','var','max','min'])`: 각 그룹별로 'price' 컬럼에 대해 평균, 분산, 최대값, 최소값을 계산하는 여러 집계 함수를 적용합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q50">
              <h2 class="question"><span class="question-number">Question 50:</span><span class="question-text">neighbourhood_group 값에 따른 reviews_per_month 평균, 분산, 최대, 최소 값을 구하여라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df[['neighbourhood_group','reviews_per_month']].groupby('neighbourhood_group').agg(['mean','var','max','min'])
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                 # `df[['neighbourhood_group','reviews_per_month']]`: 필요한 두 컬럼만 선택합니다.
                 # `.groupby('neighbourhood_group')`: 'neighbourhood_group'으로 그룹화합니다.
                 # `.agg(['mean','var','max','min'])`: 각 그룹별로 'reviews_per_month' 컬럼에 대해 평균, 분산, 최대값, 최소값을 계산합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q51">
              <h2 class="question"><span class="question-number">Question 51:</span><span class="question-text">neighbourhood 값과 neighbourhood_group 값에 따른 price 의 평균을 구하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.groupby(['neighbourhood','neighbourhood_group']).price.mean()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.groupby(['neighbourhood','neighbourhood_group'])`: 두 컬럼으로 그룹화합니다.
                # `.price`: 그룹화된 객체에서 'price' 컬럼을 선택합니다.
                # `.mean()`: 각 그룹별로 'price'의 평균값을 계산합니다. 결과는 계층적 인덱스를 가집니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q52">
              <h2 class="question"><span class="question-number">Question 52:</span><span class="question-text">neighbourhood 값과 neighbourhood_group 값에 따른 price 의 평균을<br>계층적 indexing 없이 구하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.groupby(['neighbourhood','neighbourhood_group']).price.mean().unstack()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.groupby(['neighbourhood','neighbourhood_group']).price.mean()`: Q51과 동일하게 그룹별 평균을 계산합니다.
                # `.unstack()`: 계층적 인덱스 중 가장 안쪽 레벨('neighbourhood_group')을 컬럼으로 변환하여 테이블 형태로 만듭니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q53">
              <h2 class="question"><span class="question-number">Question 53:</span><span class="question-text">neighbourhood 값과 neighbourhood_group 값에 따른 price 의 평균을<br>계층적 indexing 없이 구하고 nan 값은 -999값으로 채워라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.groupby(['neighbourhood','neighbourhood_group']).price.mean().unstack().fillna(-999)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.groupby(...).price.mean().unstack()`: Q52와 동일하게 테이블 형태로 만듭니다.
                # `.fillna(-999)`: 테이블 내의 결측치(NaN) 값을 -999로 채웁니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q54">
              <h2 class="question"><span class="question-number">Question 54:</span><span class="question-text">데이터중 neighbourhood_group 값이 Queens 값을 가지는 데이터들 중<br>neighbourhood 그룹별로 price값의 평균, 분산, 최대, 최소값을 구하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
             <div class="answer">
<pre><code class="language-python">Ans = df[df.neighbourhood_group=='Queens'].groupby(['neighbourhood']).price.agg(['mean','var','max','min'])
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df[df.neighbourhood_group=='Queens']`: 'neighbourhood_group'이 'Queens'인 행들만 필터링합니다.
                # `.groupby(['neighbourhood'])`: 필터링된 데이터를 'neighbourhood'로 그룹화합니다.
                # `.price.agg(['mean','var','max','min'])`: 각 'neighbourhood' 그룹별로 'price'의 평균, 분산, 최대, 최소값을 계산합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q55">
              <h2 class="question"><span class="question-number">Question 55:</span><span class="question-text">데이터중 neighbourhood_group 값에 따른 room_type 컬럼의 숫자를 구하고<br>neighbourhood_group 값을 기준으로 각 값의 비율을 구하여라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
             <div class="answer">
<pre><code class="language-python">Ans = df[['neighbourhood_group','room_type']].groupby(['neighbourhood_group','room_type']).size().unstack()
Ans.loc[:,:] = (Ans.values / Ans.sum(axis=1).values.reshape(-1,1))
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df[['neighbourhood_group','room_type']].groupby(...).size().unstack()`: 'neighbourhood_group'별 'room_type'의 개수를 계산하고 테이블 형태로 만듭니다.
                # `Ans.sum(axis=1)`: 각 행(neighbourhood_group)의 합계를 계산합니다.
                # `Ans.values / ... .reshape(-1,1)`: 각 셀의 값을 해당 행의 합계로 나누어 비율을 계산합니다. `.reshape(-1,1)`은 브로드캐스팅을 위해 필요합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q56">
              <h2 class="question"><span class="question-number">Question 56:</span><span class="question-text">다음 URL의 데이터를 로드하고 데이터 행과 열의 갯수를 출력하라<br>(URL: https://raw.githubusercontent.com/Datamanim/pandas/main/BankChurnersUp.csv)</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
             <div class="answer">
<pre><code class="language-python"># Question 56부터 사용할 데이터 로드
df =pd.read_csv('https://raw.githubusercontent.com/Datamanim/pandas/main/BankChurnersUp.csv',index_col=0)
Ans =df.shape
print(Ans)
# print(df.head()) # 데이터 확인용 출력 추가 (필요 시 주석 해제)
</code></pre>
            </div>
            <p class="code-comment">
                 # `pd.read_csv(..., index_col=0)`: CSV 파일을 로드하되, 첫 번째 열을 인덱스로 사용합니다.
                 # `df.shape`: 로드된 데이터프레임의 행과 열의 개수를 반환합니다.
            </p>
        </div>

        <div class="problem" data-question-id="q57">
              <h2 class="question"><span class="question-number">Question 57:</span><span class="question-text">Income_Category의 카테고리를 map 함수를 이용하여 다음과 같이 변경하고<br>newIncome 컬럼에 매핑하라<br>Unknown : N, Less than $40K : a, $40K - $60K : b, $60K - $80K : c, $80K - $120K : d, $120K + : e</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
             <div class="answer">
<pre><code class="language-python">dic = {
    'Unknown'     : 'N',
    'Less than $40K' : 'a',
    '$40K - $60K'    : 'b',
    '$60K - $80K'    : 'c',
    '$80K - $120K'    : 'd',
    '$120K +'        : 'e'    
}
df['newIncome']  =df.Income_Category.map(lambda x: dic[x])
Ans = df['newIncome']
print(Ans.head())
</code></pre>
            </div>
            <p class="code-comment">
                # `dic = {...}`: 카테고리 매핑을 위한 딕셔너리를 정의합니다.
                # `df.Income_Category.map(lambda x: dic[x])`: 'Income_Category' 컬럼의 각 값 `x`를 `dic` 딕셔너리를 이용하여 매핑합니다.
                # `df['newIncome'] = ...`: 매핑된 결과를 'newIncome' 컬럼에 저장합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q58">
            <h2 class="question"><span class="question-number">Question 58:</span><span class="question-text">Income_Category의 카테고리를 apply 함수를 이용하여 다음과 같이 변경하고<br>newIncome 컬럼에 매핑하라<br>Unknown : N, Less than $40K : a, $40K - $60K : b, $60K - $80K : c, $80K - $120K : d, $120K + : e</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">def changeCategory(x):
    if x =='Unknown':
        return 'N'
    elif x =='Less than $40K':
        return 'a'
    elif x =='$40K - $60K':    
        return 'b'
    elif x =='$60K - $80K':    
        return 'c'
    elif x =='$80K - $120K':    
        return 'd'
    elif x =='$120K +' :        
        return 'e'

df['newIncome']  =df.Income_Category.apply(changeCategory)
Ans = df['newIncome']
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `def changeCategory(x): ...`: 값 변환 로직을 담은 함수를 정의합니다.
                # `df.Income_Category.apply(changeCategory)`: 'Income_Category' 컬럼의 각 값에 `changeCategory` 함수를 적용합니다.
                # `df['newIncome'] = ...`: 적용된 결과를 'newIncome' 컬럼에 저장합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q59">
            <h2 class="question"><span class="question-number">Question 59:</span><span class="question-text">Customer_Age의 값을 이용하여 나이 구간을 AgeState 컬럼으로 정의하라.<br>(0~9 : 0, 10~19 :10, 20~29 :20 …) 각 구간의 빈도수를 출력하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df['AgeState']  = df.Customer_Age.map(lambda x: x//10 *10)
Ans = df['AgeState'].value_counts().sort_index()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.Customer_Age.map(lambda x: x//10 * 10)`: 'Customer_Age' 컬럼의 각 값 `x`를 10으로 나눈 몫에 10을 곱하여 10 단위 구간 값으로 변환합니다.
                # `df['AgeState'] = ...`: 변환된 나이 구간 값을 'AgeState' 컬럼에 저장합니다.
                # `.value_counts()`: 'AgeState' 컬럼의 각 값별 빈도수를 계산합니다.
                # `.sort_index()`: 빈도수 결과를 인덱스(나이 구간) 기준으로 정렬합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q60">
            <h2 class="question"><span class="question-number">Question 60:</span><span class="question-text">Education_Level의 값중 Graduate 단어가 포함되는 값은 1,<br>그렇지 않은 경우에는 0으로 변경하여 newEduLevel 컬럼을 정의하고 빈도수를 출력하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df['newEduLevel'] = df.Education_Level.map(lambda x : 1 if 'Graduate' in x else 0)
Ans = df['newEduLevel'].value_counts()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.Education_Level.map(lambda x : 1 if 'Graduate' in x else 0)`: 'Education_Level' 컬럼의 각 값 `x`에 'Graduate'가 포함되면 1, 아니면 0으로 매핑합니다.
                # `df['newEduLevel'] = ...`: 매핑된 결과를 'newEduLevel' 컬럼에 저장합니다.
                # `.value_counts()`: 'newEduLevel' 컬럼의 값(0 또는 1)별 빈도수를 계산합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q61">
            <h2 class="question"><span class="question-number">Question 61:</span><span class="question-text">Credit_Limit 컬럼값이 4500 이상인 경우 1, 그외의 경우에는 모두 0으로 하는<br>newLimit 컬럼을 정의하라. newLimit 각 값들의 빈도수를 출력하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df['newLimit'] = df.Credit_Limit.map(lambda x : 1 if x>=4500 else 0)
Ans = df['newLimit'].value_counts()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.Credit_Limit.map(lambda x : 1 if x>=4500 else 0)`: 'Credit_Limit' 컬럼의 각 값 `x`가 4500 이상이면 1, 아니면 0으로 매핑합니다.
                # `df['newLimit'] = ...`: 매핑된 결과를 'newLimit' 컬럼에 저장합니다.
                # `.value_counts()`: 'newLimit' 컬럼의 값(0 또는 1)별 빈도수를 계산합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q62">
            <h2 class="question"><span class="question-number">Question 62:</span><span class="question-text">Marital_Status 컬럼값이 Married 이고 Card_Category 컬럼의 값이 Platinum인 경우 1,<br>그외의 경우에는 모두 0으로 하는 newState 컬럼을 정의하라. newState의 각 값들의 빈도수를 출력하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">def check(x):
    if x.Marital_Status =='Married' and x.Card_Category =='Platinum':
        return 1
    else:
        return 0

df['newState'] = df.apply(check,axis=1)
Ans  = df['newState'].value_counts()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `def check(x): ...`: 행(`x`)을 입력받아 조건을 확인하고 1 또는 0을 반환하는 함수를 정의합니다.
                # `df.apply(check, axis=1)`: 데이터프레임의 각 행에 `check` 함수를 적용합니다 (`axis=1`).
                # `df['newState'] = ...`: 적용된 결과를 'newState' 컬럼에 저장합니다.
                # `.value_counts()`: 'newState' 컬럼의 값(0 또는 1)별 빈도수를 계산합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q63">
            <h2 class="question"><span class="question-number">Question 63:</span><span class="question-text">Gender 컬럼값 M인 경우 male, F인 경우 female로 값을 변경하여<br>Gender 컬럼에 새롭게 정의하라. 각 value의 빈도를 출력하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">def changeGender(x):
    if x =='M':
        return 'male'
    else:
        return 'female'
df['Gender'] = df.Gender.apply(changeGender)
Ans = df['Gender'].value_counts()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `def changeGender(x): ...`: 성별 값을 변환하는 함수를 정의합니다.
                # `df.Gender.apply(changeGender)`: 'Gender' 컬럼의 각 값에 `changeGender` 함수를 적용합니다.
                # `df['Gender'] = ...`: 변환된 값으로 'Gender' 컬럼을 덮어씁니다.
                # `.value_counts()`: 변경된 'Gender' 컬럼의 값('male', 'female')별 빈도수를 계산합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q64">
            <h2 class="question"><span class="question-number">Question 64:</span><span class="question-text">다음 URL의 데이터를 로드하고 각 열의 데이터 타입을 파악하라<br>(URL: https://raw.githubusercontent.com/Datamanim/pandas/main/timeTest.csv)</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df = pd.read_csv('https://raw.githubusercontent.com/Datamanim/pandas/main/timeTest.csv')
df.info()
</code></pre>
            </div>
            <p class="code-comment">
                # `pd.read_csv(...)`: CSV 파일에서 데이터를 로드합니다.
                # `df.info()`: 로드된 데이터프레임의 각 컬럼별 정보(데이터 타입 포함)를 출력합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q65">
            <h2 class="question"><span class="question-number">Question 65:</span><span class="question-text">Yr_Mo_Dy 컬럼을 판다스에서 인식할 수 있는 datetime64 타입으로 변경하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df.Yr_Mo_Dy = pd.to_datetime(df.Yr_Mo_Dy)
Ans = df.Yr_Mo_Dy
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `pd.to_datetime(df.Yr_Mo_Dy)`: 'Yr_Mo_Dy' 컬럼을 datetime64 타입으로 변환합니다.
                # `df.Yr_Mo_Dy = ...`: 변환된 결과로 컬럼을 덮어씁니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q66">
            <h2 class="question"><span class="question-number">Question 66:</span><span class="question-text">Yr_Mo_Dy에 존재하는 년도의 유일값을 모두 출력하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.Yr_Mo_Dy.dt.year.unique()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.Yr_Mo_Dy.dt.year`: datetime 타입인 'Yr_Mo_Dy' 컬럼에서 연도 정보만 추출합니다.
                # `.unique()`: 추출된 연도 값들 중 고유한 값만 반환합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q67">
            <h2 class="question"><span class="question-number">Question 67:</span><span class="question-text">Yr_Mo_Dy에 년도가 2061년 이상의 경우에는 모두 잘못된 데이터이다.<br>해당 경우의 값은 100을 빼서 새롭게 날짜를 Yr_Mo_Dy 컬럼에 정의하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">def fix_century(x):
    import datetime
    
    year = x.year - 100 if x.year >= 2061 else x.year
    return pd.to_datetime(datetime.date(year, x.month, x.day))

df['Yr_Mo_Dy'] = df['Yr_Mo_Dy'].apply(fix_century)
Ans = df.head(4)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `def fix_century(x): ...`: datetime 객체 `x`를 받아 연도를 조정하는 함수를 정의합니다. `x.year`, `x.month`, `x.day`로 각 요소에 접근합니다.
                # `pd.to_datetime(...)`: 조정된 년, 월, 일을 다시 datetime 객체로 만듭니다.
                # `df['Yr_Mo_Dy'].apply(fix_century)`: 'Yr_Mo_Dy' 컬럼의 각 datetime 값에 `fix_century` 함수를 적용합니다.
                # `df['Yr_Mo_Dy'] = ...`: 적용된 결과로 컬럼을 덮어씁니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q68">
            <h2 class="question"><span class="question-number">Question 68:</span><span class="question-text">년도별 각컬럼의 평균값을 구하여라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.groupby(df.Yr_Mo_Dy.dt.year).mean()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # `df.Yr_Mo_Dy.dt.year`: datetime 컬럼에서 연도 정보를 추출합니다.
                # `df.groupby(...)`: 추출된 연도 정보를 기준으로 데이터프레임을 그룹화합니다.
                # `.mean()`: 각 연도 그룹별로 모든 수치형 컬럼의 평균값을 계산합니다.
            </p>
        </div>
        
        <div class="problem" data-question-id="q69">
            <h2 class="question"><span class="question-number">Question 69:</span><span class="question-text">weekday 컬럼을 만들고 요일별로 매핑하라 ( 월요일: 0 ~ 일요일 :6)</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df['weekday'] = df.Yr_Mo_Dy.dt.weekday
Ans = df['weekday'].head(3).to_frame()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 'Yr_Mo_Dy' 컬럼에서 요일을 추출하여 'weekday' 컬럼을 생성합니다. (월요일: 0, 일요일: 6)
            </p>
        </div>
        
        <div class="problem" data-question-id="q70">
            <h2 class="question"><span class="question-number">Question 70:</span><span class="question-text">weekday 컬럼을 기준으로 주말이면 1, 평일이면 0의 값을 가지는<br>WeekCheck 컬럼을 만들어라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df['WeekCheck']  = df['weekday'].map(lambda x : 1 if x in [5,6] else 0)
Ans = df['WeekCheck'].head(3).to_frame()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 'weekday' 기준 주말(5,6)은 1, 평일은 0으로 'WeekCheck' 생성.
            </p>
        </div>
        
        <div class="problem" data-question-id="q71">
            <h2 class="question"><span class="question-number">Question 71:</span><span class="question-text">년도, 일자 상관없이 모든 컬럼의 각 달의 평균을 구하여라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.dropna(subset=['Yr_Mo_Dy']).groupby(df.Yr_Mo_Dy.dt.month).mean()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # NaN 제거 후, 월별 그룹화하여 컬럼 평균 계산.
            </p>
        </div>
        
        <div class="problem" data-question-id="q72">
            <h2 class="question"><span class="question-number">Question 72:</span><span class="question-text">모든 결측치는 컬럼기준 직전의 값으로 대체하고,<br>첫번째 행에 결측치가 있을 경우 뒤에 있는 값으로 대체하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df= df.fillna(method='ffill').fillna(method='bfill')
print(df.head())
</code></pre>
            </div>
            <p class="code-comment">
                # 결측치 처리: ffill 후 bfill.
            </p>
        </div>
        
        <div class="problem" data-question-id="q73">
            <h2 class="question"><span class="question-number">Question 73:</span><span class="question-text">년도-월을 기준으로 모든 컬럼의 평균값을 구하여라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python"># Ensure 'Yr_Mo_Dy' is datetime and no NaT before using to_period
Ans = df.groupby(df.Yr_Mo_Dy.dt.to_period('M')).mean()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 년-월('M') 기준 그룹화 후 컬럼 평균 계산.
            </p>
        </div>
        
        <div class="problem" data-question-id="q74">
            <h2 class="question"><span class="question-number">Question 74:</span><span class="question-text">RPT 컬럼의 값을 일자별 기준으로 1차 차분하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df['RPT'].diff()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 'RPT' 컬럼 1차 차분.
            </p>
        </div>
        
        <div class="problem" data-question-id="q75">
            <h2 class="question"><span class="question-number">Question 75:</span><span class="question-text">RPT와 VAL 컬럼을 일주일(7일) 간격으로 각각 이동평균한 값을 구하여라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans= df[['RPT','VAL']].rolling(7).mean()
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 'RPT', 'VAL' 컬럼 7일 이동 평균 계산.
            </p>
        </div>
        
        <div class="problem" data-question-id="q76">
              <h2 class="question"><span class="question-number">Question 76:</span><span class="question-text">'년-월-일:시' 컬럼을 pandas에서 인식할 수 있는 datetime 형태로 변경하라.<br>서울시 제공 데이터의 경우 0시가 24시로 표현된다.</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">def change_date(x):
    import datetime
    hour = x.split(':')[1]
    date = x.split(":")[0]
    
    if hour =='24':
        hour ='00:00:00'
        
        FinalDate = pd.to_datetime(date +" "+hour) + datetime.timedelta(days=1)
        
    else:
        hour = hour +':00:00'
        FinalDate = pd.to_datetime(date +" "+hour)
    
    return FinalDate

df['(년-월-일:시)'] = df['(년-월-일:시)'].apply(change_date)
Ans = df
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # '년-월-일:시' 컬럼 datetime 변환 (24시 -> 다음 날 0시 처리).
            </p>
        </div>
        
        <div class="problem" data-question-id="q77">
              <h2 class="question"><span class="question-number">Question 77:</span><span class="question-text">일자별 영어요일 이름을 dayName 컬럼에 저장하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df['dayName']  = df['(년-월-일:시)'].dt.day_name()
Ans = df['dayName']
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # datetime에서 요일 이름 추출하여 'dayName' 생성.
            </p>
        </div>
        
        <div class="problem" data-question-id="q78">
              <h2 class="question"><span class="question-number">Question 78:</span><span class="question-text">일자별 각 PM10등급의 빈도수를 파악하라</span></h2>
              <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
              <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans1 = df.groupby(['dayName','PM10등급'],as_index=False).size()
Ans2 = Ans1.pivot(index='dayName',columns='PM10등급',values='size').fillna(0)
print(Ans2)
</code></pre>
            </div>
            <p class="code-comment">
                # 요일별, PM10등급별 빈도수 계산 후 피벗 테이블 생성.
            </p>
        </div>
        
        <div class="problem" data-question-id="q79">
            <h2 class="question"><span class="question-number">Question 79:</span><span class="question-text">시간이 연속적으로 존재하며 결측치가 없는지 확인하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python"># 시간을 차분했을 경우 첫 값은 nan, 이후 모든 차분값이 동일하면 연속이라 판단한다.
check = len(df['(년-월-일:시)'].diff().unique())
if check ==2:
    Ans =True
else:
    Ans = False
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 시간 연속성 확인 (diff().unique() 길이 확인).
            </p>
        </div>
        
        <div class="problem" data-question-id="q80">
            <h2 class="question"><span class="question-number">Question 80:</span><span class="question-text">오전 10시와 오후 10시(22시)의 PM10의 평균값을 각각 구하여라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.groupby(df['(년-월-일:시)'].dt.hour).mean().iloc[[10,22],[0]]
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 시간별 그룹화 후 10시, 22시 PM10 평균 추출.
            </p>
        </div>
        
        <div class="problem" data-question-id="q81">
            <h2 class="question"><span class="question-number">Question 81:</span><span class="question-text">날짜 컬럼을 index로 만들어라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df.set_index('(년-월-일:시)',inplace=True,drop=True)
Ans =df
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # '(년-월-일:시)' 컬럼을 인덱스로 설정.
            </p>
        </div>
        
        <div class="problem" data-question-id="q82">
            <h2 class="question"><span class="question-number">Question 82:</span><span class="question-text">데이터를 주단위로 뽑아서 최소,최대 평균, 표준편차를 구하여라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = df.resample('W').agg(['min','max','mean','std'])
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 주 단위('W') 리샘플링 후 min, max, mean, std 계산.
            </p>
        </div>
        
        <div class="problem" data-question-id="q83">
            <h2 class="question"><span class="question-number">Question 83:</span><span class="question-text">Indicator을 삭제하고 First Tooltip 컬럼에서 신뢰구간에 해당하는 표현을 지워라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">df.drop('Indicator',axis=1,inplace=True)
df['First Tooltip'] = df['First Tooltip'].map(lambda x: float(x.split("[")[0]))
Ans = df
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 'Indicator' 컬럼 삭제, 'First Tooltip'에서 신뢰구간('[...') 제거.
            </p>
        </div>
        
        <div class="problem" data-question-id="q84">
            <h2 class="question"><span class="question-number">Question 84:</span><span class="question-text">년도가 2015년 이상, Dim1이 Both sexes인 케이스만 추출하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">target = df[(df.Period >=2015) & (df.Dim1 =='Both sexes')]
Ans = target
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # Period >= 2015 이고 Dim1 == 'Both sexes'인 행 추출.
            </p>
        </div>
        
        <div class="problem" data-question-id="q85">
            <h2 class="question"><span class="question-number">Question 85:</span><span class="question-text">84번 문제에서 추출한 데이터로 아래와 같이 나라에 따른 년도별 사망률을 데이터 프레임화 하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code class="language-python">Ans = target.pivot(index='Location',columns='Period',values='First Tooltip')
<pre><code>Ans = target.pivot(index='Location',columns='Period',values='First Tooltip')
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 나라(Location)별, 연도(Period)별 사망률(First Tooltip) 피벗.
            </p>
        </div>
        
        <div class="problem" data-question-id="q86">
            <h2 class="question"><span class="question-number">Question 86:</span><span class="question-text">Dim1에 따른 년도별 사망비율의 평균을 구하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code>Ans = df.pivot_table(index='Dim1',columns='Period',values='First Tooltip',aggfunc='mean')
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 'Dim1'별, 'Period'별 'First Tooltip' 평균 피벗 테이블.
            </p>
        </div>
        
        <div class="problem" data-question-id="q87">
            <h2 class="question"><span class="question-number">Question 87:</span><span class="question-text">데이터에서 한국 KOR 데이터만 추출하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code>kr = df[df.Country=='KOR']
Ans = kr
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # Country == 'KOR' 행 추출.
            </p>
        </div>
        
        <div class="problem" data-question-id="q88">
            <h2 class="question"><span class="question-number">Question 88:</span><span class="question-text">한국 올림픽 메달리스트 데이터에서 년도에 따른 medal 갯수를 데이터프레임화 하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code>Ans = kr.pivot_table(index='Year',columns='Medal',aggfunc='size').fillna(0)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 한국 데이터(kr)에서 연도별, 메달별 개수 피벗.
            </p>
        </div>
        
        <div class="problem" data-question-id="q89">
            <h2 class="question"><span class="question-number">Question 89:</span><span class="question-text">전체 데이터에서 sport종류에 따른 성별수를 구하여라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code>Ans = df.pivot_table(index='Sport',columns='Gender',aggfunc='size')
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 종목(Sport)별, 성별(Gender) 개수 피벗.
            </p>
        </div>
        
        <div class="problem" data-question-id="q90">
            <h2 class="question"><span class="question-number">Question 90:</span><span class="question-text">전체 데이터에서 Discipline종류에 따른 따른 Medal수를 구하여라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code>Ans = df.pivot_table(index='Discipline',columns='Medal',aggfunc='size')
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # 세부 종목(Discipline)별, 메달(Medal) 개수 피벗.
            </p>
        </div>
        
        <div class="problem" data-question-id="q91">
            <h2 class="question"><span class="question-number">Question 91:</span><span class="question-text">df1과 df2 데이터를 하나의 데이터 프레임으로 합쳐라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code>total = pd.concat([df1,df2])
Ans = total
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # df1, df2 행 방향 concat.
            </p>
        </div>
        
        <div class="problem" data-question-id="q92">
            <h2 class="question"><span class="question-number">Question 92:</span><span class="question-text">df3과 df4 데이터를 하나의 데이터 프레임으로 합쳐라. 둘다 포함하고 있는 년도에 대해서만 고려한다</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code>Ans = pd.concat([df3,df4],join='inner')
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # df3, df4 행 방향 concat (inner join).
            </p>
        </div>
        
        <div class="problem" data-question-id="q93">
            <h2 class="question"><span class="question-number">Question 93:</span><span class="question-text">df3과 df4 데이터를 하나의 데이터 프레임으로 합쳐라. 모든 컬럼을 포함하고, 결측치는 0으로 대체한다</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code>Ans = pd.concat([df3,df4],join='outer').fillna(0)
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # df3, df4 행 방향 concat (outer join), NaN은 0으로 fill.
            </p>
        </div>
        
        <div class="problem" data-question-id="q94">
            <h2 class="question"><span class="question-number">Question 94:</span><span class="question-text">df5과 df6 데이터를 하나의 데이터 프레임으로 merge함수를 이용하여 합쳐라. Algeria컬럼을 key로 하고 두 데이터 모두 포함하는 데이터만 출력하라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code>Ans = pd.merge(df5,df6,on='Algeria',how='inner')
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # df5, df6 'Algeria' 키로 inner merge.
            </p>
        </div>
        
        <div class="problem" data-question-id="q95">
            <h2 class="question"><span class="question-number">Question 95:</span><span class="question-text">df5과 df6 데이터를 하나의 데이터 프레임으로 merge함수를 이용하여 합쳐라. Algeria컬럼을 key로 하고 합집합으로 합쳐라</span></h2>
            <textarea class="user-input" placeholder="여기에 답안을 입력하세요..."></textarea>
            <button class="check-answer-btn">정답 확인</button>
            <div class="answer">
<pre><code>Ans =pd.merge(df5,df6,on='Algeria',how='outer')
print(Ans)
</code></pre>
            </div>
            <p class="code-comment">
                # df5, df6 'Algeria' 키로 outer merge.
            </p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // localStorage에서 열린 문제 상태 불러오기
            const openProblemsStorageKey = 'openPandasProblems';
            let openProblemIds = new Set(JSON.parse(localStorage.getItem(openProblemsStorageKey) || '[]'));

            // 모든 질문 요소를 선택합니다.
            const questions = document.querySelectorAll('.question');
            // 모든 정답 확인 버튼 요소를 선택합니다.
            const checkButtons = document.querySelectorAll('.check-answer-btn');

             // 페이지 로드 시 저장된 상태 복원
            openProblemIds.forEach(id => {
                const problemDiv = document.querySelector(`.problem[data-question-id="${id}"]`);
                if (problemDiv) {
                    const questionH2 = problemDiv.querySelector('.question');
                    const userInput = problemDiv.querySelector('.user-input');
                    const checkBtn = problemDiv.querySelector('.check-answer-btn');
                    // 상태 복원 (열린 상태로 만듦)
                    if (questionH2) questionH2.classList.add('open');
                    if (userInput) userInput.style.display = 'block';
                    if (checkBtn) checkBtn.style.display = 'block';
                     // Note: Answer and comment visibility is handled by the check button click, not restored here.
                }
            });

            questions.forEach(question => {
                // 각 질문에 클릭 이벤트 리스너를 추가합니다.
                question.addEventListener('click', function() {
                    // 클릭된 질문과 관련된 요소들을 찾습니다.
                    const problemDiv = this.closest('.problem'); // 부모 problem div
                    const questionId = problemDiv.dataset.questionId; // 데이터 속성에서 ID 가져오기
                    const userInput = problemDiv.querySelector('.user-input');
                    const checkBtn = problemDiv.querySelector('.check-answer-btn');
                    const answer = problemDiv.querySelector('.answer');
                    const comment = problemDiv.querySelector('.code-comment');

                    // 입력 칸과 확인 버튼의 display 상태를 토글합니다.
                    const isOpening = !this.classList.contains('open'); // 현재 닫혀있었다면 열리는 중
                    userInput.style.display = isOpening ? 'block' : 'none';
                    checkBtn.style.display = isOpening ? 'block' : 'none';

                    // localStorage 상태 업데이트
                    if (isOpening) {
                        openProblemIds.add(questionId);
                    } else {
                        openProblemIds.delete(questionId);
                        // 만약 질문을 다시 닫는 경우, 열려있던 정답/설명도 함께 닫습니다.
                        answer.style.display = 'none';
                        comment.style.display = 'none';
                    }
                    localStorage.setItem(openProblemsStorageKey, JSON.stringify(Array.from(openProblemIds)));

                    // 질문 요소에 'open' 클래스를 토글하여 +/- 표시를 변경합니다.
                    this.classList.toggle('open', isOpening);
                });
            });

            checkButtons.forEach(button => {
                 // 각 확인 버튼에 클릭 이벤트 리스너를 추가합니다.
                 button.addEventListener('click', function() {
                     // 클릭된 버튼과 관련된 요소들을 찾습니다.
                     const problemDiv = this.closest('.problem'); // 부모 problem div
                     const answerDiv = problemDiv.querySelector('.answer');
                     const comment = problemDiv.querySelector('.code-comment');

                     // 정답과 코드 설명을 보여줍니다.
                     answerDiv.style.display = 'block';
                     comment.style.display = 'block';

                     // 확인 버튼 자신은 숨깁니다.
                     this.style.display = 'none'; // 다시 버튼 숨김 활성화
                 });
            });

             // 가짜 pandas 객체 정의 (오류 방지 및 콘솔 경고용)
             if (typeof pd === 'undefined') {
                 console.warn("Pandas 라이브러리가 로드되지 않았습니다. 코드 실행은 불가능하며, 정답 확인은 코드 문자열 비교만 가능합니다.");
                 window.pd = {
                     read_csv: (url, options) => { console.log(`read_csv 호출됨: ${url}`, options); return { head: () => '가짜 데이터프레임(head)', shape: [5, 2], columns: ['col1', 'col2'], index: [0,1,2,3,4], iloc: ()=>({dtype: 'object'}), tail: ()=> '가짜 데이터프레임(tail)', select_dtypes:()=>({columns:['col1']}), isnull:()=>({sum:()=>0}), info:()=>{console.log('가짜 info 출력')}, describe:()=>'가짜 describe 출력', nunique:()=>5, unique:()=>[1,2,3,4,5], loc:()=>({head:()=>'loc 결과(head)', reset_index:()=>'loc+reset_index 결과'}), sort_values:()=>({reset_index:()=>'sort+reset_index 결과'}), str: {contains:()=>'str.contains 결과', startswith:()=>'str.startswith 결과', len:()=>({__ge__:()=>'str.len 결과'})}, isin:()=>'isin 결과', groupby:()=>({size:()=>({sort_index:()=>'groupby 결과', to_frame:()=>({rename:()=>({sort_values:()=>'groupby+rename 결과'})})}), mean:()=>'groupby mean 결과', agg:()=>'groupby agg 결과'}), drop:()=>{console.log('drop 호출됨'); return window.df; }, map:()=>'map 결과', apply:()=>'apply 결과', diff:()=>'diff 결과', rolling:()=>({mean:()=>'rolling mean 결과'}), dt: { year: { unique: ()=>[2020, 2021] }, weekday: { head: ()=>'weekday 결과' }, month: { mean: ()=>'month mean 결과' }, to_period: ()=>'to_period 결과', hour: { mean: ()=>'hour mean 결과' }, day_name: ()=>'day_name 결과' }, fillna:()=>({fillna:()=>'fillna 결과'}), pivot_table:()=>'pivot_table 결과' }; },
                     to_datetime: (data) => { console.log('to_datetime 호출됨'); return data; },
                     concat:(dfs, join)=>{ console.log(`concat 호출됨 (join=${join})`); return join === 'inner' ? 'concat inner 결과' : {fillna:()=>'concat outer+fillna 결과'}; },
                     merge:(df1, df2, on, how)=>{ console.log(`merge 호출됨 (on=${on}, how=${how})`); return 'merge 결과';}
                 };
                 // 초기 가짜 df 객체 (오류 방지용)
                 window.df = { ...window.pd.read_csv('가짜 URL'), T: {iloc:()=>({})} }; // df.T.iloc 사용 대비
             }

            // Prism.js 구문 강조 적용
            // DOM 변경 후 또는 비동기 로드 후 적용이 필요할 수 있으므로, 약간의 지연을 둘 수 있습니다.
            // setTimeout(() => { Prism.highlightAll(); }, 0);
            // 또는 특정 요소만 타겟팅:
            // document.querySelectorAll('.answer pre code').forEach((block) => {
            //   Prism.highlightElement(block);
            // });
            Prism.highlightAll(); // 일반적으로 DOMContentLoaded 후에는 바로 실행해도 괜찮습니다.
        });
    </script>
    <!-- Prism.js JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <!-- Python 언어 지원은 autoloader가 자동으로 처리합니다 -->
</body>
</html>
